var portfolio = [
    {
        category: 'games',
        minImg: 'neon_city/320min.png',
        url: ['neon_city/1.png', 'neon_city/2.png', 'neon_city/3.png', 'neon_city/4.png', 'neon_city/5.png', 'neon_city/6.png', 'neon_city/7.gif', 'neon_city/8.gif', 'neon_city/9.gif', 'neon_city/10.gif'],
        title: 'Neon City',
        subtitle: 'Mobile Game',
        description: 'Neon City is casual mobile game for Android and iOS systems.'
    },
    {
        category: 'illustrations',
        minImg: 'girl_walks_home_alone/320min.png',
        url: ['girl_walks_home_alone/1.png'],
        title: 'A Girl Walks Home Alone At Night',
        subtitle: 'Vector Graphic',
        description: 'Alternative poster for the movie "A Girl Walks Home Alone At Night", Director: Ana Lily Amirpour.'
    },
    {
        category: 'games',
        minImg: 'space_student/320min.png',
        url: ['space_student/1.Menu_glowne-01.png', 'space_student/2.Menu_buy_character.png', 'space_student/3.Menu_crash-01.png', 'space_student/4.lot_gif.gif'],
        title: 'Space Student',
        subtitle: 'Mobile Game',
        description: 'Space Student is casual mobile game for Android and iOS systems.'
    },
    {
        category: 'illustrations',
        minImg: 'viking_of_valhalla/320min.png',
        url: ['viking_of_valhalla/1.jpg', 'viking_of_valhalla/2.png', 'viking_of_valhalla/3.png', 'viking_of_valhalla/4.png', 'viking_of_valhalla/5.jpg'],
        title: 'Viking of Valhalla',
        subtitle: 'poster',
        description: 'Poster project, vector illustration, print format: A2.'
    },
    {
        category: 'illustrations',
        minImg: 'lion/320min.png',
        url: ['lion/1.jpg', 'lion/2.jpg'],
        title: 'Lion',
        subtitle: 'low poly illustration',
        description: ''
    },
    {
        category: 'illustrations',
        minImg: 'giant/320min.png',
        url: ['giant/1.png'],
        title: 'Giant',
        subtitle: 'illustration',
        description: 'Illustration printable.'
    },
    {
        category: 'illustrations',
        minImg: 'soldier_bear/320min.png',
        url: ['soldier_bear/1.png'],
        title: 'Wojtek - The Soldier Bear',
        subtitle: 'Vector Graphic',
        description: 'Wojtek - a Syrian brown bear found in Iran and adopted by soldiers of the 22nd Artillery Supply Company of the Polish II Corps. He was later officially enlisted as a soldier of the company with the rank of Private, and subsequently became a Corporal. During the Battle of Monte Cassino, Wojtek helped move crates of ammunition. Vector illustration for printing on T-shirt.'
    },
    {
        category: 'illustrations',
        minImg: 'steam-noir/320min.png',
        url: ['steam-noir/1.png'],
        title: 'Steam-Noir',
        subtitle: 'Vector Graphic',
        description: 'Vector illustration inspired by comic books.'
    },
    {
        category: 'illustrations',
        minImg: 'polish_eagle/320min.png',
        url: ['polish_eagle/1.png', 'polish_eagle/2.jpg'],
        title: 'Polish Eagle',
        subtitle: 'T-shirt',
        description: 'Design of patriotic t-shirt.'
    },
    {
        category: 'illustrations',
        minImg: 'polish_eagle_2/320min.png',
        url: ['polish_eagle_2/1.png', 'polish_eagle_2/2.jpg'],
        title: 'Polish Eagle Vol.2',
        subtitle: 'T-shirt',
        description: 'Design of patriotic t-shirt.'
    },
    {
        category: 'illustrations',
        minImg: 'soldier_bear_2/320min.png',
        url: ['soldier_bear_2/1.jpg'],
        title: 'Wojtek - The Soldier Bear Vol.2',
        subtitle: 'low poly illustration',
        description: 'Wojtek - a Syrian brown bear found in Iran and adopted by soldiers of the 22nd Artillery Supply Company of the Polish II Corps. He was later officially enlisted as a soldier of the company with the rank of Private, and subsequently became a Corporal. During the Battle of Monte Cassino, Wojtek helped move crates of ammunition. Vector illustration for printing on T-shirt. Illustration in "low-poly" style.'
    },
    {
        category: 'illustrations',
        minImg: 'fingerman/320min.png',
        url: ['fingerman/1.png', 'fingerman/2.jpg'],
        title: 'fingerman',
        subtitle: 'T-shirt',
        description: 'Comic illustration, t-shirt design.'
    },
    {
        category: 'illustrations',
        minImg: 'phantom/320min.png',
        url: ['phantom/1.png'],
        title: 'phantom',
        subtitle: 'Illustration',
        description: ''
    },
    {
        category: 'illustrations',
        minImg: 'flying_island/320min.png',
        url: ['flying_island/1.jpg'],
        title: 'Flying Islands',
        subtitle: 'Digital Art',
        description: 'Abstract collage - raster illustration. A0 format.'
    },
    {
        category: 'other',
        minImg: 'land_of_loess_gorges/320min.png',
        url: ['land_of_loess_gorges/1.png','land_of_loess_gorges/2.png','land_of_loess_gorges/3.png'],
        title: 'A Land Of Loess Gorges',
        subtitle: 'Aplication Project',
        description: 'Tourist mobile application for Android system.'
    },
    {
        category: 'illustrations',
        minImg: 'portraits/320min.png',
        url: ['portraits/1.jpg','portraits/2.jpg','portraits/3.jpg','portraits/4.jpg','portraits/5.jpg'],
        title: 'portraits',
        subtitle: 'Digital Art',
        description: 'A series of abstract portraits made for the American company.'
    },
    {
        category: 'other',
        minImg: 'adam_wroblewski/320min.png',
        url: ['adam_wroblewski/1.png','adam_wroblewski/2.png'],
        title: 'Branding for Adam Wróblewski',
        subtitle: 'corporate identity',
        description: "Branding for Adam Wróblewski's office."
    },
    {
        category: 'other',
        minImg: 'sinaloa/320min.png',
        url: ['sinaloa/1.png','sinaloa/2.jpg','sinaloa/3.png','sinaloa/4.png'],
        title: 'Sinaloa',
        subtitle: 'corporate identity',
        description: "Sinaloa - mexican mobile catering. Branding and food truck projekct."
    },
    {
        category: 'illustrations',
        minImg: 'tree/320min.png',
        url: ['tree/1.jpg'],
        title: 'Tree',
        subtitle: 'Blouse project',
        description: 'Handmade blouse project.'
    },
    {
        category: 'illustrations',
        minImg: 'money/320min.png',
        url: ['money/1.jpg', 'money/2.jpg'],
        title: 'Money',
        subtitle: 'T-shirt',
        description: 'T-shirt design. Vector illustration.'
    },
    {
        category: 'illustrations',
        minImg: 'gasman/320min.png',
        url: ['gasman/1.jpg'],
        title: 'Gasman',
        subtitle: 'T-shirt',
        description: 'T-shirt design. Vector illustration.'
    },
    {
        category: 'other',
        minImg: 'posters/320min.png',
        url: ['posters/1.jpg','posters/2.jpg','posters/3.png'],
        title: 'posters',
        subtitle: '',
        description: "Poster projects for cultural events."
    },
    {
        category: 'illustrations',
        minImg: 'elephantman/320min.png',
        url: ['elephantman/1.jpg'],
        title: 'elephantman',
        subtitle: 'collage',
        description: ''
    },
    {
        category: 'illustrations',
        minImg: 'samurai/320min.png',
        url: ['samurai/1.jpg'],
        title: 'samurai',
        subtitle: 'vector graphic',
        description: ''
    },
    {
        category: 'other',
        minImg: 'confectionery/320min.png',
        url: ['confectionery/1.jpg','confectionery/2.jpg'],
        title: 'Staropolska Confectionery',
        subtitle: 'Packaging design',
        description: "Packaging design for Staropolska Confectionery."
    }

]
var currentObject = null;
var currentCategory = 'all'


$(document).ready(function () {
    $('#nav-icon1').click(function () {
        $(this).toggleClass('open');
        //$('#mainMenu').toggleClass('open');
        $('#mainMenu').slideToggle();
    });

    setupPortfolio()
    setupNavigation()
});

function setupNavigation() {

  activateMenuOnScroll()

  $('#mainMenu a[href*=#]:not([href=#])').on('click', function() {
    $('.main .active').removeClass('active')
    $(this).parent().toggleClass('active')
       if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
         var target = $(this.hash);
           target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
           if (target.length) {
               $('html,body').animate({
                   scrollTop: target.offset().top - $('.main').height()
               }, 300);
               return false;
           }
       }
   });
}

function activateMenuOnScroll() {
  // Cache selectors
var lastId,
    topMenu = $("#mainMenu"),
    topMenuHeight = topMenu.outerHeight()+100,
    // All list items
    menuItems = topMenu.find("a"),
    // Anchors corresponding to menu items
    scrollItems = menuItems.map(function(){
      var item = $($(this).attr("href"));
      if (item.length) { return item; }
    });

// Bind to scroll
$(window).scroll(function(){
   // Get container scroll position
   var fromTop = $(this).scrollTop()+topMenuHeight;

   // Get id of current scroll item
   var cur = scrollItems.map(function(){
     if ($(this).offset().top < fromTop)
       return this;
   });
   // Get the id of the current element
   cur = cur[cur.length-1];
   var id = cur && cur.length ? cur[0].id : "";

   if (lastId !== id) {
       lastId = id;
       // Set/remove active class
       menuItems
         .parent().removeClass("active")
         .end().filter("[href='#"+id+"']").parent().addClass("active");
   }
 });
}

function setupPortfolio() {
    filterCategory()
    prepareMinImgs()

    //close div with big images
    $('.port_end').click(function(){
      $('#port_el').hide()
    })

    $('#next_img').click(function(){
        var el = _.find(portfolio, currentObject)
        var portfolio2 = portfolio
        if(currentCategory !== 'all') {
          portfolio2 = portfolio.filter(function(el){
            return el.category === currentCategory
          })
        }

        var index = portfolio2.indexOf(el)
        if(index > -1 && portfolio2.length > index+1) {
          showProject(portfolio2[index+1])
        }
    })

    $('#prev_img').click(function(){
        var el = _.find(portfolio, currentObject)
        var portfolio2 = portfolio
        if(currentCategory !== 'all') {
          portfolio2 = portfolio.filter(function(el){
            return el.category === currentCategory
          })
        }

        var index = portfolio2.indexOf(el)
        if(index > 0) {
          showProject(portfolio2[index-1])
        }
    })


}

function prepareMinImgs(category){
  var html = preparePortfolioHtml(category)

  $('#portfolio-min').html(html)
  scrollToBigImg()
  $('.img__min').click(function () {


    $('#port_el').show()
    portfolio.forEach(function (obj) {
        if ($(this).attr('src').includes(obj.minImg)) {
          showProject(obj)
          }
    }.bind(this))

  })
}

function scrollToBigImg() {
      $('#portfolio a[href*=#]:not([href=#])').click(function() {
           if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
             var target = $(this.hash);
               target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
               if (target.length) {
                   $('html,body').animate({
                       scrollTop: target.offset().top - $('.main').height()
                   }, 300);
                   return false;
               }
           }
       });
}

function showProject(obj) {
    currentObject = obj
    $('#port_el .port_text').html(obj.title);
    $('#port_el .port_text1').html(obj.subtitle);
    $('#port_el .port_text3').html(obj.description);
    var mainImgHtml = prepareMainImg(obj);
    $('#main-img').html(mainImgHtml);
}

function filterCategory() {
  $('#portfolio .nav2__el a').click(function(e) {

    var cat = $(this).attr('data-category')
    currentCategory = cat

    $("#main-img").attr('data-category', cat)
    prepareMinImgs(cat)
  });

}

function prepareMainImg(el) {
    var html = ''
    el.url.forEach(function (url) {
        html += '<div class="row"><div class="col-11 med_col-11 xl_col-7">'
        html += '<img class="port_img" src="media/images/' + el.category + '/' + url + '">'
        html += '</div></div>'
    })
    return html
}

function preparePortfolioHtml(category) {

  portfolioFiltered = portfolio
    if(category && category !== 'all') {
      var portfolioFiltered = portfolio.filter(function(el){
        return el.category === category
      })
    }
    var html = '<div class="xl_col-2"></div>'
    portfolioFiltered.forEach(function (el, index) {

        html += '<div class="col-6 xl_col-2 med_col-4">'
        html += '<a href="#port_el"><img class="img__min cat-'+el.category+'" src="media/images/' + el.category + '/' + el.minImg + '"></a>'
        html += '</div>'
        if ((index + 1) % 4 === 0) {
            html += '<div class="xl_col-2"></div>'
            if (index !== portfolio.length - 1) {
                html += '<div class="xl_col-2"></div>'
            }
        }
    })
    return html
}
